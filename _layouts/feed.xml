<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" {% if site.lang %}xml:lang="{{ site.lang }}"{% endif %}>
  <generator uri="https://jekyllrb.com/" version="{{ jekyll.version }}">Jekyll</generator>
  <link href="{{ site.url }}{{ site.baseurl }}/feed.xml" rel="self" type="application/atom+xml" />
  <link href="{{ site.url }}{{ site.baseurl }}/" rel="alternate" type="text/html" {% if site.lang %}hreflang="{{ site.lang }}" {% endif %}/>
  <updated>{{ site.time | date_to_xmlschema }}</updated>
  <id>{{ site.url }}{{ site.baseurl }}/</id>
  {% if site.title %}
    <title type="html">{{ site.title | smartify | xml_escape }}</title>
  {% elsif site.name %}
    <title type="html">{{ site.name | smartify | xml_escape }}</title>
  {% endif %}

  {% if site.description %}
    <subtitle>{{ site.description | xml_escape }}</subtitle>
  {% endif %}

  {% if site.author %}
    <author>
      <name>{{ site.author.name | default: site.author | xml_escape }}</name>
      {% if site.author.email %}
        <email>{{ site.author.email | xml_escape }}</email>
      {% endif %}
      {% if site.author.uri %}
        <uri>{{ site.author.uri | xml_escape }}</uri>
      {% endif %}
    </author>
  {% endif %}

  {% assign posts = site.posts | where_exp: "post", "post.draft != true" %}
  {% if site.feed.posts_limit %}
    {% assign posts = posts | limit: site.feed.posts_limit %}
  {% endif %}

  {% for post in posts %}
    <entry>
      <title type="html">{{ post.title | smartify | strip_html | normalize_whitespace | xml_escape }}</title>
      <link href="{{ post.url | absolute_url }}" rel="alternate" type="text/html" title="{{ post.title | xml_escape }}" />
      <published>{{ post.date | date_to_xmlschema }}</published>
      <updated>{{ post.last_modified_at | default: post.date | date_to_xmlschema }}</updated>
      <id>{{ post.id | absolute_url | xml_escape }}</id>
      <post_type>{{ post.layout }}</post_type>
      {% if post.short-description %}
        <summary type="html">{{ post.short-description | strip_html | normalize_whitespace | xml_escape }}</summary>
      {% elsif post.excerpt %}
        <summary type="html">{{ post.excerpt | strip_html | normalize_whitespace | xml_escape }}</summary>
      {% endif %}

      {% if post.img %}
        {% capture img_url %}{{ site.url }}{{ site.baseurl }}/assets/img/{{ post.layout }}/{{ post.img }}{% endcapture %}
        <link rel="enclosure" type="image/jpeg" href="{{ img_url }}" />
        <media:content url="{{ img_url }}" medium="image">
          <media:title type="html">{{ post.img-text | default: post.title | xml_escape }}</media:title>
        </media:content>
      {% endif %}

      <content type="html" xml:base="{{ post.url | absolute_url | xml_escape }}"><![CDATA[{% if post.img %}<img src="{{ site.url }}{{ site.baseurl }}/assets/img/article/{{ post.img }}" alt="{{ post.img-text | default: post.title }}" style="max-width: 100%; height: auto;" />{% endif %}{% if post.short-description %}<p><strong>{{ post.short-description }}</strong></p>{% endif %}{{ post.content }}]]></content>

      <author>
        <name>{{ post.author.name | default: post.author | default: site.author.name | default: site.author | xml_escape }}</name>
      </author>
    </entry>
  {% endfor %}
</feed>
